@page "/roster/{userId:int}"

@inject Data.IFNFData FNFData
@inject Data.CustomAuthenticationStateProvider CustomAuthenticationStateProvider
@inject NavigationManager Navigation

<PageTitle>Roster</PageTitle>

@if (user is not null)
{
    <div class="pa-2 mb-8">
        <MudText Typo="Typo.h4" HtmlTag="i"><b>@user.TeamName</b></MudText>
    </div>
}

@if (userRoster is not null)
{
    @foreach (var player in userRoster)
    {
        <PlayerPointCard Player="@player" />
    }
}

@code {
    
    [Parameter]
    public int userId { get; set; }

    private Data.User? user;
    private IEnumerable<Data.FNFPlayer>? userRoster;

    protected override async Task OnInitializedAsync()
    {
        if (string.IsNullOrEmpty(CustomAuthenticationStateProvider.CurrentUser.Email))
        {
            Navigation.NavigateTo("/");
        }
        
        user = await FNFData.GetUserByIdAsync(userId);
        if (user is not null)
        {
            userRoster = await FNFData.GetRosterAsync(user.Id);
        }
    }
}